<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Insert title here</title>
		
		<link rel="stylesheet" href="/mail/resources/css/MailSender.css">
		
		<script src="/mail/resources/js/httpRequest.js"></script>
		
		<script>
			/* from으로 conrtoller 호출 param 값 전송 post 방식  Ajax*/
			function mailCheck(f){
				let userEmail = f.userEmail.value;
				let url = "mailCheck.do";
				let param = "email="+userEmail;
				sendRequest( url, param, resultMail, "post" );
			}
			
			let res;
			/* 전달 받은 controller 에서 받은 data 확인 */
			function resultMail(){
				if( xhr.readyState == 4 && xhr.status == 200 ){
					
					let data = xhr.responseText;
					alert( "인증코드가 이메일로 전송 되었습니다" );
					
					let check_input = document.getElementById("check_input");
					check_input.disabled = false;
					
					res = data;
					
				}
			}
			function change_input(){
				
				let check_input = document.getElementById("check_input");
				let mail_check_warn = 
					document.getElementById("mail_check_warn");
				
				if( check_input.value == res ){
					mail_check_warn.innerHTML = "인증성공";
					mail_check_warn.style.color = "#28a745";
				}else{
					mail_check_warn.innerHTML = "인증번호 불일치";
					mail_check_warn.style.color = "#dc3545";
				}				
				
				
			}
			
		</script>
		
	</head>
	
	<body>
		<form>
		<div id="main_box">
			<div class="page_title">이메일 인증</div>
			<hr/>
			<div class="type_content"><input type="email" name="userEmail" placeholder="email address"/></div>
			<div><input type="button" value="본인인증"
				   onclick="mailCheck(this.form)"/></div> <br>
				   
			<div class="type_content"><input type="text" id="check_input" placeholder="인증번호 6자리"
				   maxlength="6" disabled="disabled"/>	</div>
			
			<div>
			<input type="button" value="인증번호 확인"
				   onclick="change_input()"/> <!-- onclick 버튼으로 함수 호출  -->
			</div>
			<div id="mail_check_warn"></div>
		</div>				      
		</form>
	</body>
</html>























